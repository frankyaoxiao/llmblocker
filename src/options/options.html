<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Focus Guard Settings</title>
  <link rel="stylesheet" href="options.css">
</head>
<body>
  <div class="options-container">
    <!-- Header -->
    <header class="header">
      <h1>Focus Guard Settings</h1>
      <p class="subtitle">Configure your AI-powered web filtering</p>
    </header>

    <div class="content">
      <!-- LLM Provider Section -->
      <section class="settings-section">
        <h2>AI Provider</h2>
        <p class="section-description">
          Choose your preferred provider and configure API access.
        </p>

        <div class="form-group">
          <label for="provider-select">AI Provider</label>
          <select id="provider-select" class="form-select">
            <option value="">Select a provider...</option>
            <option value="openrouter">OpenRouter (Multiple Models)</option>
            <option value="openai">OpenAI (GPT Models)</option>
            <option value="anthropic">Anthropic (Claude Models)</option>
          </select>
        </div>

        <div class="form-group">
          <label for="model-select">Model</label>
          <select id="model-select" class="form-select" disabled>
            <option value="">Select a model...</option>
          </select>
          <div class="help-text">
            Choose a model that balances speed and accuracy for your needs.
          </div>
        </div>

        <div class="form-group">
          <label for="api-key">API Key</label>
          <div class="input-group">
            <input 
              type="password" 
              id="api-key" 
              class="form-input" 
              placeholder="Enter your API key..."
              disabled
            />
            <button id="toggle-key-visibility" class="toggle-btn" disabled>üëÅÔ∏è</button>
          </div>
          <div class="help-text">
            Your API key is stored securely and never shared.
            <a id="provider-docs-link" href="#" target="_blank" class="help-link">Get API Key</a>
          </div>
        </div>

        <div id="api-status" class="status-indicator hidden">
          <div class="status-content">
            <span id="status-icon">‚è≥</span>
            <span id="status-message">Testing API connection...</span>
          </div>
        </div>
      </section>

      <!-- Blocking Behavior Section -->
      <section class="settings-section">
        <h2>Blocking Behavior</h2>
        <p class="section-description">
          Customize how the extension analyzes and blocks pages.
        </p>

        <div class="form-group">
          <label for="confidence-threshold">
            Confidence Threshold: <span id="threshold-value">75</span>%
          </label>
          <input 
            type="range" 
            id="confidence-threshold" 
            class="form-range"
            min="0" 
            max="100" 
            value="75"
          />
          <div class="threshold-labels">
            <span>Permissive (0%)</span>
            <span>Strict (100%)</span>
          </div>
          <div class="help-text">
            Higher values block fewer pages but with higher confidence.
            Lower values are more aggressive but may have false positives.
          </div>
        </div>

        <div class="form-group">
          <div class="checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" id="enable-extension" checked>
              <span class="checkbox-custom"></span>
              Enable Focus Guard
            </label>
          </div>
          <div class="help-text">
            When disabled, all pages will be allowed through.
          </div>
        </div>
      </section>

      <!-- Advanced Settings Section -->
      <section class="settings-section">
        <h2>Advanced Settings</h2>
        <p class="section-description">
          Fine-tune performance and behavior settings.
        </p>

        <div class="form-group">
          <label for="rate-limit">Requests per minute</label>
          <input 
            type="number" 
            id="rate-limit" 
            class="form-input"
            min="1" 
            max="60" 
            value="20"
          />
          <div class="help-text">
            Limit API requests to avoid hitting provider rate limits.
          </div>
        </div>

        <div class="form-group">
          <div class="checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" id="enable-cache" checked>
              <span class="checkbox-custom"></span>
              Enable result caching
            </label>
          </div>
          <div class="help-text">
            Cache analysis results to reduce API calls for similar content.
          </div>
        </div>
      </section>

      <!-- Statistics Section -->
      <section class="settings-section">
        <h2>Usage Statistics</h2>
        <p class="section-description">
          Monitor your extension usage and performance.
        </p>

        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-value" id="total-requests">0</div>
            <div class="stat-label">Pages Analyzed</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="blocked-pages">0</div>
            <div class="stat-label">Pages Blocked</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="bypassed-pages">0</div>
            <div class="stat-label">Bypasses Used</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="current-goals">0</div>
            <div class="stat-label">Active Goals</div>
          </div>
        </div>

        <!-- Token Usage Section -->
        <div class="token-usage-section">
          <h3>Token Usage (Last 7 Days)</h3>
          
          <div class="token-stats-grid">
            <div class="token-stat-card">
              <div class="token-stat-value" id="total-input-tokens">0</div>
              <div class="token-stat-label">Input Tokens</div>
            </div>
            <div class="token-stat-card">
              <div class="token-stat-value" id="total-output-tokens">0</div>
              <div class="token-stat-label">Output Tokens</div>
            </div>
            <div class="token-stat-card">
              <div class="token-stat-value" id="total-api-requests">0</div>
              <div class="token-stat-label">API Requests</div>
            </div>
          </div>

          <div class="provider-breakdown" id="provider-breakdown">
            <!-- Provider-specific token usage will be populated here -->
          </div>
        </div>

        <div class="form-group">
          <button id="reset-stats" class="btn btn-secondary">
            Reset Statistics
          </button>
        </div>
      </section>

      <!-- Data Management Section -->
      <section class="settings-section">
        <h2>Data Management</h2>
        <p class="section-description">
          Export, import, or reset your extension data.
        </p>

        <div class="button-group">
          <button id="export-data" class="btn btn-secondary">
            Export Settings
          </button>
          <button id="import-data" class="btn btn-secondary">
            Import Settings
          </button>
          <button id="reset-all" class="btn btn-danger">
            Reset All Data
          </button>
        </div>

        <input type="file" id="import-file" accept=".json" class="hidden">
      </section>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-content">
        <div class="save-status">
          <span id="save-status" class="save-indicator">All changes saved</span>
        </div>
        <div class="footer-links">
          <a href="#" id="help-link">Help</a>
          <a href="#" id="github-link">GitHub</a>
          <span class="version">v1.0.0</span>
        </div>
      </div>
    </footer>
  </div>

  <script src="../shared/constants.js"></script>
  <script src="../shared/utils.js"></script>
  <script src="../shared/storage.js"></script>
  <script src="options.js"></script>
</body>
</html>